<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - Skillr</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 100%);
            color: #fff;
            font-family: 'Segoe UI', Arial, sans-serif;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            flex: 1;
        }

        /* Header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding: 20px 0;
            border-bottom: 2px solid rgba(255, 215, 0, 0.3);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            text-decoration: none;
        }

        .logo h1 {
            font-size: 1.8rem;
            background: linear-gradient(45deg, #FFD700, #FF8C00);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .admin-info {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .admin-badge {
            background: linear-gradient(45deg, #FF4444, #CC0000);
            color: white;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: bold;
        }

        /* Admin Layout */
        .admin-layout {
            display: grid;
            grid-template-columns: 250px 1fr;
            gap: 30px;
            min-height: 80vh;
        }

        /* Sidebar */
        .admin-sidebar {
            background: rgba(30, 30, 46, 0.9);
            border-radius: 15px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            height: fit-content;
        }

        .admin-nav {
            list-style: none;
        }

        .admin-nav li {
            margin-bottom: 5px;
        }

        .admin-nav a {
            display: flex;
            align-items: center;
            gap: 12px;
            color: #aaa;
            text-decoration: none;
            padding: 15px;
            border-radius: 8px;
            transition: all 0.3s ease;
            font-size: 1rem;
        }

        .admin-nav a:hover,
        .admin-nav a.active {
            color: #FFD700;
            background: rgba(255, 215, 0, 0.1);
        }

        .nav-icon {
            font-size: 1.2rem;
            width: 24px;
            text-align: center;
        }

        /* Main Content */
        .admin-content {
            background: rgba(30, 30, 46, 0.9);
            border-radius: 15px;
            padding: 30px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* Dashboard Stats */
        .dashboard-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            padding: 25px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            border-color: #FFD700;
            transform: translateY(-5px);
        }

        .stat-icon {
            font-size: 2.5rem;
            margin-bottom: 15px;
        }

        .stat-value {
            font-size: 2.2rem;
            font-weight: bold;
            color: #FFD700;
            margin-bottom: 5px;
        }

        .stat-label {
            color: #aaa;
            font-size: 0.9rem;
        }

        /* Table Styles */
        .table-container {
            overflow-x: auto;
            margin: 20px 0;
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .admin-table {
            width: 100%;
            border-collapse: collapse;
            min-width: 800px;
        }

        .admin-table th {
            background: rgba(255, 215, 0, 0.1);
            color: #FFD700;
            padding: 15px;
            text-align: left;
            font-weight: bold;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .admin-table td {
            padding: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            color: #ccc;
        }

        .admin-table tr:hover {
            background: rgba(255, 215, 0, 0.05);
        }

        /* Form Styles */
        .form-section {
            margin-bottom: 40px;
        }

        .form-title {
            font-size: 1.5rem;
            color: #FFD700;
            margin-bottom: 25px;
            padding-bottom: 10px;
            border-bottom: 2px solid rgba(255, 215, 0, 0.3);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }

        @media (max-width: 768px) {
            .form-grid {
                grid-template-columns: 1fr;
            }
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            color: #ccc;
            margin-bottom: 8px;
            font-size: 0.95rem;
            font-weight: 500;
        }

        .form-input,
        .form-select,
        .form-textarea {
            width: 100%;
            padding: 14px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            color: #fff;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .form-input:focus,
        .form-select:focus,
        .form-textarea:focus {
            outline: none;
            border-color: #FFD700;
            box-shadow: 0 0 0 2px rgba(255, 215, 0, 0.2);
        }

        .form-textarea {
            min-height: 120px;
            resize: vertical;
        }

        /* Button Styles */
        .btn-group {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }

        .btn {
            padding: 14px 28px;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(45deg, #FFD700, #FF8C00);
            color: #000;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(255, 215, 0, 0.3);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: #aaa;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.2);
            color: #fff;
        }

        .btn-danger {
            background: rgba(255, 68, 68, 0.1);
            color: #ff4444;
            border: 1px solid rgba(255, 68, 68, 0.3);
        }

        .btn-danger:hover {
            background: #ff4444;
            color: white;
        }

        .btn-success {
            background: linear-gradient(45deg, #00C851, #007E33);
            color: white;
        }

        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0, 200, 81, 0.3);
        }

        .btn-sm {
            padding: 8px 16px;
            font-size: 0.85rem;
        }

        /* Action Buttons */
        .action-buttons {
            display: flex;
            gap: 8px;
        }

        /* Status Badges */
        .status-badge {
            display: inline-block;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: bold;
            text-transform: uppercase;
        }

        .status-open {
            background: rgba(0, 255, 0, 0.15);
            color: #00ff00;
            border: 1px solid rgba(0, 255, 0, 0.3);
        }

        .status-closed {
            background: rgba(255, 68, 68, 0.15);
            color: #ff4444;
            border: 1px solid rgba(255, 68, 68, 0.3);
        }

        .status-pending {
            background: rgba(255, 215, 0, 0.15);
            color: #FFD700;
            border: 1px solid rgba(255, 215, 0, 0.3);
        }

        .status-success {
            background: rgba(0, 200, 81, 0.15);
            color: #00C851;
            border: 1px solid rgba(0, 200, 81, 0.3);
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .modal-content {
            background: #1a1a2e;
            border-radius: 15px;
            padding: 30px;
            max-width: 500px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            border: 2px solid #FFD700;
            position: relative;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .modal-title {
            color: #FFD700;
            font-size: 1.5rem;
        }

        .close-modal {
            background: none;
            border: none;
            color: #aaa;
            font-size: 1.5rem;
            cursor: pointer;
            padding: 5px;
        }

        .close-modal:hover {
            color: #fff;
        }

        /* Notification Panel */
        .notification-panel {
            background: rgba(255, 215, 0, 0.05);
            border-radius: 10px;
            padding: 20px;
            margin-top: 30px;
            border: 1px solid rgba(255, 215, 0, 0.2);
        }

        /* Export Options */
        .export-options {
            display: flex;
            gap: 10px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .export-btn {
            background: rgba(255, 255, 255, 0.05);
            color: #FFD700;
            border: 1px solid rgba(255, 215, 0, 0.3);
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .export-btn:hover {
            background: rgba(255, 215, 0, 0.1);
        }

        /* Loading */
        .loading {
            text-align: center;
            padding: 60px 20px;
            color: #FFD700;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(255, 215, 0, 0.3);
            border-top: 4px solid #FFD700;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Search and Filters */
        .search-filter-bar {
            display: flex;
            gap: 15px;
            margin: 20px 0;
            flex-wrap: wrap;
            align-items: center;
        }

        .search-input {
            flex: 1;
            min-width: 200px;
            padding: 12px 20px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 25px;
            color: #fff;
            font-size: 1rem;
        }

        .filter-select {
            padding: 12px 20px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 25px;
            color: #fff;
            font-size: 1rem;
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .admin-layout {
                grid-template-columns: 1fr;
            }
            
            .admin-sidebar {
                display: flex;
                overflow-x: auto;
                padding: 15px;
            }
            
            .admin-nav {
                display: flex;
                gap: 10px;
            }
            
            .admin-nav li {
                margin-bottom: 0;
            }
            
            .admin-nav a {
                white-space: nowrap;
            }
        }

        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                gap: 20px;
                text-align: center;
            }
            
            .admin-info {
                flex-direction: column;
                gap: 10px;
            }
            
            .dashboard-stats {
                grid-template-columns: 1fr;
            }
            
            .btn-group {
                flex-direction: column;
            }
            
            .action-buttons {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <a href="index.html" class="logo">
                <span style="font-size: 2rem;">üéÆ</span>
                <h1>SKILLR</h1>
            </a>
            
            <div class="admin-info">
                <div class="admin-badge">ADMIN PANEL</div>
                <div id="adminName" style="color: #FFD700; font-weight: bold;">Administrator</div>
                <button class="btn btn-danger btn-sm" onclick="logout()">üö™ Logout</button>
            </div>
        </div>

        <!-- Admin Layout -->
        <div class="admin-layout">
            <!-- Sidebar -->
            <div class="admin-sidebar">
                <ul class="admin-nav">
                    <li><a href="#" class="active" onclick="showSection('dashboard')">
                        <span class="nav-icon">üìä</span> Dashboard
                    </a></li>
                    <li><a href="#" onclick="showSection('tournaments')">
                        <span class="nav-icon">üèÜ</span> Tournaments
                    </a></li>
                    <li><a href="#" onclick="showSection('create-tournament')">
                        <span class="nav-icon">‚ûï</span> Create Tournament
                    </a></li>
                    <li><a href="#" onclick="showSection('payments')">
                        <span class="nav-icon">üí∞</span> Payments
                    </a></li>
                    <li><a href="#" onclick="showSection('users')">
                        <span class="nav-icon">üë•</span> Users
                    </a></li>
                    <li><a href="#" onclick="showSection('notifications')">
                        <span class="nav-icon">üì¢</span> Notifications
                    </a></li>
                    <li><a href="#" onclick="showSection('reports')">
                        <span class="nav-icon">üìà</span> Reports
                    </a></li>
                </ul>
            </div>

            <!-- Main Content -->
            <div class="admin-content">
                <!-- Dashboard -->
                <div id="dashboardSection" class="admin-section">
                    <h2 class="form-title">üìä Admin Dashboard</h2>
                    
                    <!-- Stats Cards -->
                    <div class="dashboard-stats">
                        <div class="stat-card">
                            <div class="stat-icon">üèÜ</div>
                            <div class="stat-value" id="totalTournaments">0</div>
                            <div class="stat-label">Active Tournaments</div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon">üë•</div>
                            <div class="stat-value" id="totalUsers">0</div>
                            <div class="stat-label">Total Users</div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon">üí∞</div>
                            <div class="stat-value" id="totalRevenue">GHS 0</div>
                            <div class="stat-label">Total Revenue</div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon">üìà</div>
                            <div class="stat-value" id="todayRegistrations">0</div>
                            <div class="stat-label">Today's Registrations</div>
                        </div>
                    </div>

                    <!-- Recent Activity -->
                    <div class="form-section">
                        <h3 class="form-title">üïê Recent Activity</h3>
                        <div class="table-container">
                            <table class="admin-table">
                                <thead>
                                    <tr>
                                        <th>Time</th>
                                        <th>Activity</th>
                                        <th>User</th>
                                        <th>Details</th>
                                    </tr>
                                </thead>
                                <tbody id="recentActivity">
                                    <!-- Filled by JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Tournaments Management -->
                <div id="tournamentsSection" class="admin-section" style="display: none;">
                    <div class="search-filter-bar">
                        <input type="text" class="search-input" id="tournamentSearch" 
                               placeholder="Search tournaments..." onkeyup="searchTournaments()">
                        <select class="filter-select" id="tournamentFilter" onchange="filterTournaments()">
                            <option value="all">All Status</option>
                            <option value="Open">Open</option>
                            <option value="Closed">Closed</option>
                            <option value="Coming Soon">Coming Soon</option>
                        </select>
                        <button class="btn btn-primary" onclick="refreshTournaments()">
                            üîÑ Refresh
                        </button>
                    </div>

                    <div class="table-container">
                        <table class="admin-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Title</th>
                                    <th>Game</th>
                                    <th>Entry Fee</th>
                                    <th>Players</th>
                                    <th>Status</th>
                                    <th>Date</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="tournamentsTable">
                                <!-- Filled by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Create Tournament -->
                <div id="createTournamentSection" class="admin-section" style="display: none;">
                    <h2 class="form-title">‚ûï Create New Tournament</h2>
                    
                    <form id="createTournamentForm">
                        <div class="form-grid">
                            <div class="form-group">
                                <label class="form-label">Game Title</label>
                                <input type="text" class="form-input" id="tournamentGame" 
                                       placeholder="e.g., Call of Duty: Mobile" required>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Tournament Title</label>
                                <input type="text" class="form-input" id="tournamentTitle" 
                                       placeholder="e.g., CODM Solo Tournament" required>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Entry Fee (GHS)</label>
                                <input type="number" class="form-input" id="tournamentEntryFee" 
                                       min="0" step="0.01" value="10" required>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Prize Pool (GHS)</label>
                                <input type="number" class="form-input" id="tournamentPrize" 
                                       min="0" step="0.01" value="100" required>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Max Players</label>
                                <input type="number" class="form-input" id="tournamentMaxPlayers" 
                                       min="2" value="100" required>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Date</label>
                                <input type="date" class="form-input" id="tournamentDate" required>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Time</label>
                                <input type="time" class="form-input" id="tournamentTime" required>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Status</label>
                                <select class="form-select" id="tournamentStatus">
                                    <option value="Open">Open</option>
                                    <option value="Coming Soon">Coming Soon</option>
                                    <option value="Closed">Closed</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Description</label>
                            <textarea class="form-textarea" id="tournamentDescription" 
                                      placeholder="Describe the tournament..." required></textarea>
                        </div>
                        
                        <div class="form-grid">
                            <div class="form-group">
                                <label class="form-label">Game Mode</label>
                                <input type="text" class="form-input" id="tournamentMode" 
                                       placeholder="e.g., Solo, Duo, Squad" required>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Map</label>
                                <input type="text" class="form-input" id="tournamentMap" 
                                       placeholder="e.g., Battle Royale, Bermuda" required>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Organizer</label>
                                <input type="text" class="form-input" id="tournamentOrganizer" 
                                       value="Skillr Gaming Association" required>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Contact</label>
                                <input type="text" class="form-input" id="tournamentContact" 
                                       placeholder="e.g., 055 123 4567" required>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Rules (one per line)</label>
                            <textarea class="form-textarea" id="tournamentRules" 
                                      placeholder="Enter each rule on a new line" required>No cheating or hacking
Solo play only - no teaming
Standard battle royale rules apply
Disconnection during match = elimination
Prize distributed within 24 hours of tournament end</textarea>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Schedule (one per line)</label>
                            <textarea class="form-textarea" id="tournamentSchedule" 
                                      placeholder="Enter each schedule item on a new line" required>17:30 - Registration closes
18:00 - Tournament starts
18:30 - Round 1 complete
19:00 - Final round
19:30 - Winner announced</textarea>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Prize Distribution (one per line)</label>
                            <textarea class="form-textarea" id="tournamentPrizeDistribution" 
                                      placeholder="Enter each prize on a new line" required>1st Place: GHS 100
2nd Place: GHS 50
3rd Place: GHS 30</textarea>
                        </div>
                        
                        <div class="btn-group">
                            <button type="submit" class="btn btn-primary">
                                üèÜ Create Tournament
                            </button>
                            <button type="reset" class="btn btn-secondary">
                                üîÑ Reset Form
                            </button>
                        </div>
                    </form>
                </div>

                <!-- Payments Management -->
                <div id="paymentsSection" class="admin-section" style="display: none;">
                    <h2 class="form-title">üí∞ Payment Management</h2>
                    
                    <div class="search-filter-bar">
                        <input type="text" class="search-input" id="paymentSearch" 
                               placeholder="Search payments..." onkeyup="searchPayments()">
                        <select class="filter-select" id="paymentFilter" onchange="filterPayments()">
                            <option value="all">All Status</option>
                            <option value="success">Success</option>
                            <option value="failed">Failed</option>
                            <option value="pending">Pending</option>
                        </select>
                        <select class="filter-select" id="paymentMethodFilter" onchange="filterPayments()">
                            <option value="all">All Methods</option>
                            <option value="MTN">MTN MoMo</option>
                            <option value="Vodafone">Vodafone Cash</option>
                        </select>
                    </div>
                    
                    <div class="export-options">
                        <button class="export-btn" onclick="exportPayments('csv')">
                            üì• Export as CSV
                        </button>
                        <button class="export-btn" onclick="exportPayments('excel')">
                            üìä Export as Excel
                        </button>
                        <button class="export-btn" onclick="exportPayments('pdf')">
                            üìÑ Export as PDF
                        </button>
                    </div>

                    <div class="table-container">
                        <table class="admin-table">
                            <thead>
                                <tr>
                                    <th>Ref No</th>
                                    <th>Tournament</th>
                                    <th>Player</th>
                                    <th>Amount</th>
                                    <th>Method</th>
                                    <th>Phone</th>
                                    <th>Date</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="paymentsTable">
                                <!-- Filled by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Users Management -->
                <div id="usersSection" class="admin-section" style="display: none;">
                    <h2 class="form-title">üë• User Management</h2>
                    
                    <div class="search-filter-bar">
                        <input type="text" class="search-input" id="userSearch" 
                               placeholder="Search users..." onkeyup="searchUsers()">
                        <select class="filter-select" id="userFilter" onchange="filterUsers()">
                            <option value="all">All Users</option>
                            <option value="active">Active</option>
                            <option value="inactive">Inactive</option>
                            <option value="banned">Banned</option>
                        </select>
                    </div>

                    <div class="table-container">
                        <table class="admin-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Username</th>
                                    <th>Email</th>
                                    <th>Phone</th>
                                    <th>Joined</th>
                                    <th>Tournaments</th>
                                    <th>Winnings</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="usersTable">
                                <!-- Filled by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Notifications -->
                <div id="notificationsSection" class="admin-section" style="display: none;">
                    <h2 class="form-title">üì¢ Send Notifications</h2>
                    
                    <form id="notificationForm">
                        <div class="form-group">
                            <label class="form-label">Notification Type</label>
                            <select class="form-select" id="notificationType" onchange="toggleNotificationFields()">
                                <option value="all">All Users</option>
                                <option value="tournament">Tournament Specific</option>
                                <option value="user">Specific User</option>
                                <option value="winners">Tournament Winners</option>
                                <option value="payment">Payment Alert</option>
                            </select>
                        </div>
                        
                        <div id="tournamentField" class="form-group" style="display: none;">
                            <label class="form-label">Select Tournament</label>
                            <select class="form-select" id="notificationTournament">
                                <!-- Filled by JavaScript -->
                            </select>
                        </div>
                        
                        <div id="userField" class="form-group" style="display: none;">
                            <label class="form-label">Select User</label>
                            <select class="form-select" id="notificationUser">
                                <!-- Filled by JavaScript -->
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Subject</label>
                            <input type="text" class="form-input" id="notificationSubject" 
                                   placeholder="Notification subject..." required>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Message</label>
                            <textarea class="form-textarea" id="notificationMessage" 
                                      rows="6" placeholder="Enter your message..." required></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Send Method</label>
                            <div style="display: flex; gap: 20px; margin-top: 10px;">
                                <label>
                                    <input type="checkbox" id="sendInApp" checked> In-App Notification
                                </label>
                                <label>
                                    <input type="checkbox" id="sendSMS"> SMS
                                </label>
                                <label>
                                    <input type="checkbox" id="sendEmail"> Email
                                </label>
                            </div>
                        </div>
                        
                        <div class="btn-group">
                            <button type="submit" class="btn btn-primary">
                                üì§ Send Notification
                            </button>
                            <button type="button" class="btn btn-secondary" onclick="showNotificationHistory()">
                                üìú View History
                            </button>
                        </div>
                    </form>
                    
                    <div id="notificationHistory" style="display: none; margin-top: 40px;">
                        <h3 class="form-title">üìú Notification History</h3>
                        <div class="table-container">
                            <table class="admin-table">
                                <thead>
                                    <tr>
                                        <th>Date</th>
                                        <th>Type</th>
                                        <th>Subject</th>
                                        <th>Recipients</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody id="notificationHistoryTable">
                                    <!-- Filled by JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Reports -->
                <div id="reportsSection" class="admin-section" style="display: none;">
                    <h2 class="form-title">üìà Reports & Analytics</h2>
                    
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label">Report Type</label>
                            <select class="form-select" id="reportType" onchange="updateReportFilters()">
                                <option value="revenue">Revenue Report</option>
                                <option value="registrations">Registration Report</option>
                                <option value="users">User Growth</option>
                                <option value="tournaments">Tournament Performance</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Time Period</label>
                            <select class="form-select" id="reportPeriod">
                                <option value="today">Today</option>
                                <option value="week">This Week</option>
                                <option value="month">This Month</option>
                                <option value="quarter">This Quarter</option>
                                <option value="year">This Year</option>
                                <option value="custom">Custom Range</option>
                            </select>
                        </div>
                        
                        <div id="customRange" class="form-grid" style="display: none; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 10px;">
                            <div class="form-group">
                                <label class="form-label">From Date</label>
                                <input type="date" class="form-input" id="reportFromDate">
                            </div>
                            <div class="form-group">
                                <label class="form-label">To Date</label>
                                <input type="date" class="form-input" id="reportToDate">
                            </div>
                        </div>
                    </div>
                    
                    <div class="btn-group">
                        <button class="btn btn-primary" onclick="generateReport()">
                            üìä Generate Report
                        </button>
                        <button class="btn btn-success" onclick="exportReport()">
                            üì• Export Report
                        </button>
                    </div>
                    
                    <div id="reportResults" style="margin-top: 40px;">
                        <!-- Report results will be displayed here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modals -->
    <div id="editTournamentModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">‚úèÔ∏è Edit Tournament</h3>
                <button class="close-modal" onclick="closeModal('editTournamentModal')">&times;</button>
            </div>
            <div id="editTournamentFormContainer">
                <!-- Filled by JavaScript -->
            </div>
        </div>
    </div>

    <div id="viewRegistrationsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">üìã Tournament Registrations</h3>
                <button class="close-modal" onclick="closeModal('viewRegistrationsModal')">&times;</button>
            </div>
            <div id="registrationsList">
                <!-- Filled by JavaScript -->
            </div>
        </div>
    </div>

    <div id="paymentDetailsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">üí∞ Payment Details</h3>
                <button class="close-modal" onclick="closeModal('paymentDetailsModal')">&times;</button>
            </div>
            <div id="paymentDetailsContent">
                <!-- Filled by JavaScript -->
            </div>
        </div>
    </div>

    <div id="userDetailsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">üë§ User Details</h3>
                <button class="close-modal" onclick="closeModal('userDetailsModal')">&times;</button>
            </div>
            <div id="userDetailsContent">
                <!-- Filled by JavaScript -->
            </div>
        </div>
    </div>

    <div id="sendNotificationModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">üì¢ Send Quick Notification</h3>
                <button class="close-modal" onclick="closeModal('sendNotificationModal')">&times;</button>
            </div>
            <form id="quickNotificationForm">
                <div class="form-group">
                    <label class="form-label">Message</label>
                    <textarea class="form-textarea" id="quickNotificationMessage" 
                              rows="4" placeholder="Enter your message..." required></textarea>
                </div>
                <div class="btn-group">
                    <button type="submit" class="btn btn-primary">
                        üì§ Send
                    </button>
                    <button type="button" class="btn btn-secondary" onclick="closeModal('sendNotificationModal')">
                        Cancel
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // ==================== GLOBAL VARIABLES ====================
        let adminToken = null;
        let adminData = null;
        let tournamentsData = [];
        let usersData = [];
        let paymentsData = [];
        let notificationsData = [];

        // ==================== AUTHENTICATION ====================
        async function checkAdminAuth() {
            const token = localStorage.getItem('authToken');
            const userData = localStorage.getItem('user');
            
            if (!token || !userData) {
                window.location.href = 'login.html';
                return;
            }
            
            try {
                const user = JSON.parse(userData);
                
                // Check if user is admin (simplified check)
                // In real app, check user.role === 'admin'
                if (!user.isAdmin) {
                    // For demo, allow all users to access admin panel
                    // In production: window.location.href = 'index.html';
                }
                
                adminToken = token;
                adminData = user;
                
                document.getElementById('adminName').textContent = `üëë ${user.username || 'Administrator'}`;
                
                // Load initial data
                loadDashboardData();
                loadTournaments();
                loadUsers();
                loadPayments();
                
            } catch (error) {
                console.error('Auth error:', error);
                window.location.href = 'login.html';
            }
        }

        function logout() {
            if (confirm('Are you sure you want to logout?')) {
                localStorage.removeItem('authToken');
                localStorage.removeItem('user');
                window.location.href = 'login.html';
            }
        }

        // ==================== DASHBOARD FUNCTIONS ====================
        async function loadDashboardData() {
            try {
                // Load stats
                const [tournamentsRes, usersRes, paymentsRes] = await Promise.all([
                    fetch('http://localhost:5000/api/tournaments'),
                    fetch('http://localhost:5000/api/users'),
                    fetch('http://localhost:5000/api/payments')
                ]);

                if (tournamentsRes.ok) {
                    const tournaments = await tournamentsRes.json();
                    document.getElementById('totalTournaments').textContent = 
                        tournaments.tournaments?.length || 0;
                }

                // Load recent activity
                loadRecentActivity();
                
            } catch (error) {
                console.error('Dashboard error:', error);
            }
        }

        async function loadRecentActivity() {
            try {
                // In a real app, fetch from API
                const activities = [
                    { time: 'Just now', activity: 'User registered', user: 'Player123', details: 'New user signup' },
                    { time: '5 min ago', activity: 'Payment processed', user: 'GamerPro', details: 'GHS 25.00 - CODM Tournament' },
                    { time: '10 min ago', activity: 'Tournament created', user: 'Admin', details: 'New Free Fire tournament' },
                    { time: '1 hour ago', activity: 'Prize distributed', user: 'Winner1', details: 'GHS 100 sent via MTN' },
                    { time: '2 hours ago', activity: 'Notification sent', user: 'All Users', details: 'New tournament announcement' }
                ];

                const activityTable = document.getElementById('recentActivity');
                activityTable.innerHTML = activities.map(activity => `
                    <tr>
                        <td><span style="color: #FFD700">${activity.time}</span></td>
                        <td>${activity.activity}</td>
                        <td>${activity.user}</td>
                        <td>${activity.details}</td>
                    </tr>
                `).join('');
                
            } catch (error) {
                console.error('Activity error:', error);
            }
        }

        // ==================== TOURNAMENT MANAGEMENT ====================
        async function loadTournaments() {
            try {
                const response = await fetch('http://localhost:5000/api/tournaments');
                const data = await response.json();
                tournamentsData = data.tournaments || [];
                displayTournaments(tournamentsData);
            } catch (error) {
                console.error('Load tournaments error:', error);
                tournamentsData = [];
            }
        }

        function displayTournaments(tournaments) {
            const table = document.getElementById('tournamentsTable');
            
            if (!tournaments || tournaments.length === 0) {
                table.innerHTML = `
                    <tr>
                        <td colspan="8" style="text-align: center; padding: 40px;">
                            <div style="color: #aaa; font-size: 1.1rem;">
                                üèÜ No tournaments found
                            </div>
                        </td>
                    </tr>
                `;
                return;
            }

            table.innerHTML = tournaments.map(tournament => {
                const statusClass = tournament.status === 'Open' ? 'status-open' :
                                  tournament.status === 'Closed' ? 'status-closed' : 'status-pending';
                
                return `
                    <tr>
                        <td>${tournament.id}</td>
                        <td><strong>${tournament.title}</strong><br>
                            <small style="color: #aaa;">${tournament.game}</small>
                        </td>
                        <td>${tournament.game}</td>
                        <td><span class="ghs">GHS ${tournament.entryFee}</span></td>
                        <td>${tournament.players}/${tournament.maxPlayers}</td>
                        <td><span class="status-badge ${statusClass}">${tournament.status}</span></td>
                        <td>${formatDate(tournament.date)}</td>
                        <td>
                            <div class="action-buttons">
                                <button class="btn btn-sm btn-secondary" onclick="editTournament(${tournament.id})">
                                    ‚úèÔ∏è Edit
                                </button>
                                <button class="btn btn-sm btn-primary" onclick="viewRegistrations(${tournament.id})">
                                    üìã View
                                </button>
                                <button class="btn btn-sm btn-danger" onclick="deleteTournament(${tournament.id})">
                                    üóëÔ∏è Delete
                                </button>
                                <button class="btn btn-sm btn-success" onclick="generateBracket(${tournament.id})">
                                    üèÄ Bracket
                                </button>
                            </div>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        async function editTournament(id) {
            const tournament = tournamentsData.find(t => t.id === id);
            if (!tournament) return;

            const formHTML = `
                <form id="editTournamentForm" onsubmit="updateTournament(event, ${id})">
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label">Title</label>
                            <input type="text" class="form-input" value="${tournament.title}" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Game</label>
                            <input type="text" class="form-input" value="${tournament.game}" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Entry Fee (GHS)</label>
                            <input type="number" class="form-input" value="${tournament.entryFee}" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Prize Pool (GHS)</label>
                            <input type="number" class="form-input" value="${tournament.prize}" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Max Players</label>
                            <input type="number" class="form-input" value="${tournament.maxPlayers}" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Status</label>
                            <select class="form-select">
                                <option value="Open" ${tournament.status === 'Open' ? 'selected' : ''}>Open</option>
                                <option value="Closed" ${tournament.status === 'Closed' ? 'selected' : ''}>Closed</option>
                                <option value="Coming Soon" ${tournament.status === 'Coming Soon' ? 'selected' : ''}>Coming Soon</option>
                            </select>
                        </div>
                    </div>
                    <div class="btn-group">
                        <button type="submit" class="btn btn-primary">üíæ Save Changes</button>
                        <button type="button" class="btn btn-secondary" onclick="closeModal('editTournamentModal')">Cancel</button>
                    </div>
                </form>
            `;

            document.getElementById('editTournamentFormContainer').innerHTML = formHTML;
            openModal('editTournamentModal');
        }

        async function updateTournament(event, id) {
            event.preventDefault();
            
            const form = event.target;
            const formData = {
                title: form.querySelector('input[type="text"]').value,
                game: form.querySelectorAll('input[type="text"]')[1].value,
                entryFee: parseFloat(form.querySelector('input[type="number"]').value),
                prize: parseFloat(form.querySelectorAll('input[type="number"]')[1].value),
                maxPlayers: parseInt(form.querySelectorAll('input[type="number"]')[2].value),
                status: form.querySelector('select').value
            };

            try {
                // In a real app, call API: PUT /api/admin/tournaments/{id}
                alert('Tournament updated successfully!');
                closeModal('editTournamentModal');
                loadTournaments();
            } catch (error) {
                console.error('Update error:', error);
                alert('Failed to update tournament');
            }
        }

        async function viewRegistrations(id) {
            const tournament = tournamentsData.find(t => t.id === id);
            if (!tournament) return;

            try {
                // In a real app, fetch registrations from API
                const registrations = [
                    { id: 1, username: 'Player1', email: 'player1@example.com', phone: '0551111111', registeredAt: '2024-12-10' },
                    { id: 2, username: 'Player2', email: 'player2@example.com', phone: '0552222222', registeredAt: '2024-12-10' },
                    { id: 3, username: 'Player3', email: 'player3@example.com', phone: '0553333333', registeredAt: '2024-12-09' }
                ];

                const html = `
                    <h4 style="color: #FFD700; margin-bottom: 20px;">${tournament.title}</h4>
                    <div class="table-container">
                        <table class="admin-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Username</th>
                                    <th>Email</th>
                                    <th>Phone</th>
                                    <th>Registered</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${registrations.map(reg => `
                                    <tr>
                                        <td>${reg.id}</td>
                                        <td>${reg.username}</td>
                                        <td>${reg.email}</td>
                                        <td>${reg.phone}</td>
                                        <td>${reg.registeredAt}</td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                    <div style="margin-top: 20px; text-align: center;">
                        <button class="btn btn-primary" onclick="exportRegistrations(${id})">
                            üì• Export Registrations
                        </button>
                    </div>
                `;

                document.getElementById('registrationsList').innerHTML = html;
                openModal('viewRegistrationsModal');
            } catch (error) {
                console.error('View registrations error:', error);
            }
        }

        async function generateBracket(id) {
            if (!confirm('Generate bracket for this tournament? Ensure all players are registered.')) return;
            
            try {
                const response = await fetch(`http://localhost:5000/api/tournament/${id}/generate-bracket`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${adminToken}`,
                        'Content-Type': 'application/json'
                    }
                });
                const data = await response.json();
                if (data.success) {
                    alert('Bracket generated successfully!');
                } else {
                    alert('Error: ' + data.error);
                }
            } catch (error) {
                console.error('Bracket generation error:', error);
                alert('Failed to generate bracket');
            }
        }

        async function deleteTournament(id) {
            if (confirm('Are you sure you want to delete this tournament? This action cannot be undone.')) {
                try {
                    // In a real app, call API: DELETE /api/admin/tournaments/{id}
                    alert('Tournament deleted successfully!');
                    loadTournaments();
                } catch (error) {
                    console.error('Delete error:', error);
                    alert('Failed to delete tournament');
                }
            }
        }

        function searchTournaments() {
            const searchTerm = document.getElementById('tournamentSearch').value.toLowerCase();
            const filtered = tournamentsData.filter(t => 
                t.title.toLowerCase().includes(searchTerm) ||
                t.game.toLowerCase().includes(searchTerm)
            );
            displayTournaments(filtered);
        }

        function filterTournaments() {
            const filter = document.getElementById('tournamentFilter').value;
            const searchTerm = document.getElementById('tournamentSearch').value.toLowerCase();
            
            let filtered = tournamentsData;
            
            if (filter !== 'all') {
                filtered = filtered.filter(t => t.status === filter);
            }
            
            if (searchTerm) {
                filtered = filtered.filter(t => 
                    t.title.toLowerCase().includes(searchTerm) ||
                    t.game.toLowerCase().includes(searchTerm)
                );
            }
            
            displayTournaments(filtered);
        }

        // ==================== CREATE TOURNAMENT ====================
        document.getElementById('createTournamentForm').addEventListener('submit', async function(event) {
            event.preventDefault();
            
            const form = event.target;
            const formData = {
                game: document.getElementById('tournamentGame').value,
                title: document.getElementById('tournamentTitle').value,
                description: document.getElementById('tournamentDescription').value,
                entryFee: parseFloat(document.getElementById('tournamentEntryFee').value),
                prize: parseFloat(document.getElementById('tournamentPrize').value),
                maxPlayers: parseInt(document.getElementById('tournamentMaxPlayers').value),
                date: document.getElementById('tournamentDate').value,
                time: document.getElementById('tournamentTime').value,
                status: document.getElementById('tournamentStatus').value,
                mode: document.getElementById('tournamentMode').value,
                map: document.getElementById('tournamentMap').value,
                organizer: document.getElementById('tournamentOrganizer').value,
                contact: document.getElementById('tournamentContact').value,
                rules: document.getElementById('tournamentRules').value.split('\n').filter(r => r.trim()),
                schedule: document.getElementById('tournamentSchedule').value.split('\n').filter(s => s.trim()),
                prizeDistribution: document.getElementById('tournamentPrizeDistribution').value.split('\n').filter(p => p.trim())
            };

            try {
                // In a real app, call API: POST /api/admin/tournaments
                const response = await fetch('http://localhost:5000/api/tournaments', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${adminToken}`
                    },
                    body: JSON.stringify(formData)
                });

                if (response.ok) {
                    alert('Tournament created successfully!');
                    form.reset();
                    loadTournaments();
                    showSection('tournaments');
                } else {
                    throw new Error('Failed to create tournament');
                }
            } catch (error) {
                console.error('Create tournament error:', error);
                alert('Failed to create tournament');
            }
        });

        // ==================== PAYMENT MANAGEMENT ====================
        async function loadPayments() {
            try {
                // In a real app, fetch from API
                paymentsData = [
                    { 
                        reference: 'PMT-123456', 
                        tournament: 'CODM Solo Tournament', 
                        player: 'GamerPro', 
                        amount: 10, 
                        method: 'MTN', 
                        phone: '0551234567', 
                        date: '2024-12-10', 
                        status: 'success' 
                    },
                    { 
                        reference: 'PMT-123457', 
                        tournament: 'Free Fire Squad Battle', 
                        player: 'Player2', 
                        amount: 20, 
                        method: 'Vodafone', 
                        phone: '0249876543', 
                        date: '2024-12-10', 
                        status: 'success' 
                    },
                    { 
                        reference: 'PMT-123458', 
                        tournament: 'PUBG Duo Tournament', 
                        player: 'Player3', 
                        amount: 15, 
                        method: 'MTN', 
                        phone: '0501122334', 
                        date: '2024-12-09', 
                        status: 'failed' 
                    }
                ];
                displayPayments(paymentsData);
            } catch (error) {
                console.error('Load payments error:', error);
                paymentsData = [];
            }
        }

        function displayPayments(payments) {
            const table = document.getElementById('paymentsTable');
            
            if (!payments || payments.length === 0) {
                table.innerHTML = `
                    <tr>
                        <td colspan="9" style="text-align: center; padding: 40px;">
                            <div style="color: #aaa; font-size: 1.1rem;">
                                üí∞ No payments found
                            </div>
                        </td>
                    </tr>
                `;
                return;
            }

            table.innerHTML = payments.map(payment => {
                const statusClass = payment.status === 'success' ? 'status-success' :
                                  payment.status === 'failed' ? 'status-closed' : 'status-pending';
                
                return `
                    <tr>
                        <td><code>${payment.reference}</code></td>
                        <td>${payment.tournament}</td>
                        <td>${payment.player}</td>
                        <td><span class="ghs">GHS ${payment.amount}</span></td>
                        <td>${payment.method}</td>
                        <td>${payment.phone}</td>
                        <td>${payment.date}</td>
                        <td><span class="status-badge ${statusClass}">${payment.status}</span></td>
                        <td>
                            <div class="action-buttons">
                                <button class="btn btn-sm btn-secondary" onclick="viewPaymentDetails('${payment.reference}')">
                                    üëÅÔ∏è View
                                </button>
                                ${payment.status === 'success' ? `
                                    <button class="btn btn-sm btn-danger" onclick="processRefund('${payment.reference}')">
                                        üí∏ Refund
                                    </button>
                                ` : ''}
                            </div>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        function viewPaymentDetails(reference) {
            const payment = paymentsData.find(p => p.reference === reference);
            if (!payment) return;

            const html = `
                <div style="padding: 20px;">
                    <h4 style="color: #FFD700; margin-bottom: 20px;">Payment Details</h4>
                    <div style="background: rgba(255,255,255,0.05); padding: 20px; border-radius: 10px;">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px;">
                            <div>
                                <p style="color: #aaa; margin-bottom: 5px;">Reference:</p>
                                <p style="color: white; font-weight: bold;">${payment.reference}</p>
                            </div>
                            <div>
                                <p style="color: #aaa; margin-bottom: 5px;">Status:</p>
                                <p><span class="status-badge ${payment.status === 'success' ? 'status-success' : 'status-closed'}">${payment.status}</span></p>
                            </div>
                            <div>
                                <p style="color: #aaa; margin-bottom: 5px;">Amount:</p>
                                <p style="color: #FFD700; font-weight: bold; font-size: 1.2rem;">GHS ${payment.amount}</p>
                            </div>
                            <div>
                                <p style="color: #aaa; margin-bottom: 5px;">Method:</p>
                                <p style="color: white;">${payment.method}</p>
                            </div>
                            <div>
                                <p style="color: #aaa; margin-bottom: 5px;">Tournament:</p>
                                <p style="color: white;">${payment.tournament}</p>
                            </div>
                            <div>
                                <p style="color: #aaa; margin-bottom: 5px;">Player:</p>
                                <p style="color: white;">${payment.player}</p>
                            </div>
                            <div>
                                <p style="color: #aaa; margin-bottom: 5px;">Phone:</p>
                                <p style="color: white;">${payment.phone}</p>
                            </div>
                            <div>
                                <p style="color: #aaa; margin-bottom: 5px;">Date:</p>
                                <p style="color: white;">${payment.date}</p>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            document.getElementById('paymentDetailsContent').innerHTML = html;
            openModal('paymentDetailsModal');
        }

        function processRefund(reference) {
            if (confirm(`Are you sure you want to process a refund for payment ${reference}?`)) {
                alert(`Refund processed for ${reference}`);
                // In a real app, call API to process refund
            }
        }

        function searchPayments() {
            const searchTerm = document.getElementById('paymentSearch').value.toLowerCase();
            const filtered = paymentsData.filter(p => 
                p.reference.toLowerCase().includes(searchTerm) ||
                p.tournament.toLowerCase().includes(searchTerm) ||
                p.player.toLowerCase().includes(searchTerm)
            );
            displayPayments(filtered);
        }

        function filterPayments() {
            const statusFilter = document.getElementById('paymentFilter').value;
            const methodFilter = document.getElementById('paymentMethodFilter').value;
            const searchTerm = document.getElementById('paymentSearch').value.toLowerCase();
            
            let filtered = paymentsData;
            
            if (statusFilter !== 'all') {
                filtered = filtered.filter(p => p.status === statusFilter);
            }
            
            if (methodFilter !== 'all') {
                filtered = filtered.filter(p => p.method === methodFilter);
            }
            
            if (searchTerm) {
                filtered = filtered.filter(p => 
                    p.reference.toLowerCase().includes(searchTerm) ||
                    p.tournament.toLowerCase().includes(searchTerm) ||
                    p.player.toLowerCase().includes(searchTerm)
                );
            }
            
            displayPayments(filtered);
        }

        function exportPayments(format) {
            alert(`Exporting payments as ${format.toUpperCase()}...`);
            // In a real app, implement export functionality
        }

        // ==================== USER MANAGEMENT ====================
        async function loadUsers() {
            try {
                // In a real app, fetch from API
                usersData = [
                    { id: 1, username: 'GamerPro', email: 'player@example.com', phone: '0551234567', 
                      joined: '2024-01-01', tournaments: 5, winnings: 250, status: 'active' },
                    { id: 2, username: 'Player2', email: 'player2@example.com', phone: '0249876543', 
                      joined: '2024-02-15', tournaments: 3, winnings: 150, status: 'active' },
                    { id: 3, username: 'Player3', email: 'player3@example.com', phone: '0501122334', 
                      joined: '2024-03-20', tournaments: 1, winnings: 0, status: 'inactive' },
                    { id: 4, username: 'Cheater1', email: 'cheater@example.com', phone: '0543344556', 
                      joined: '2024-04-01', tournaments: 2, winnings: 0, status: 'banned' }
                ];
                displayUsers(usersData);
            } catch (error) {
                console.error('Load users error:', error);
                usersData = [];
            }
        }

        function displayUsers(users) {
            const table = document.getElementById('usersTable');
            
            if (!users || users.length === 0) {
                table.innerHTML = `
                    <tr>
                        <td colspan="9" style="text-align: center; padding: 40px;">
                            <div style="color: #aaa; font-size: 1.1rem;">
                                üë• No users found
                            </div>
                        </td>
                    </tr>
                `;
                return;
            }

            table.innerHTML = users.map(user => {
                const statusClass = user.status === 'active' ? 'status-success' :
                                  user.status === 'banned' ? 'status-closed' : 'status-pending';
                
                return `
                    <tr>
                        <td>${user.id}</td>
                        <td><strong>${user.username}</strong></td>
                        <td>${user.email}</td>
                        <td>${user.phone}</td>
                        <td>${user.joined}</td>
                        <td>${user.tournaments}</td>
                        <td><span class="ghs">GHS ${user.winnings}</span></td>
                        <td><span class="status-badge ${statusClass}">${user.status}</span></td>
                        <td>
                            <div class="action-buttons">
                                <button class="btn btn-sm btn-secondary" onclick="viewUserDetails(${user.id})">
                                    üëÅÔ∏è View
                                </button>
                                ${user.status === 'active' ? `
                                    <button class="btn btn-sm btn-danger" onclick="toggleUserStatus(${user.id}, 'banned')">
                                        üö´ Ban
                                    </button>
                                ` : user.status === 'banned' ? `
                                    <button class="btn btn-sm btn-success" onclick="toggleUserStatus(${user.id}, 'active')">
                                        ‚úÖ Unban
                                    </button>
                                ` : ''}
                                <button class="btn btn-sm btn-primary" onclick="sendUserNotification(${user.id})">
                                    üì¢ Notify
                                </button>
                            </div>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        function viewUserDetails(id) {
            const user = usersData.find(u => u.id === id);
            if (!user) return;

            const html = `
                <div style="padding: 20px;">
                    <h4 style="color: #FFD700; margin-bottom: 20px;">User Details</h4>
                    <div style="background: rgba(255,255,255,0.05); padding: 20px; border-radius: 10px;">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px;">
                            <div>
                                <p style="color: #aaa; margin-bottom: 5px;">Username:</p>
                                <p style="color: white; font-weight: bold;">${user.username}</p>
                            </div>
                            <div>
                                <p style="color: #aaa; margin-bottom: 5px;">Status:</p>
                                <p><span class="status-badge ${user.status === 'active' ? 'status-success' : 'status-closed'}">${user.status}</span></p>
                            </div>
                            <div>
                                <p style="color: #aaa; margin-bottom: 5px;">Email:</p>
                                <p style="color: white;">${user.email}</p>
                            </div>
                            <div>
                                <p style="color: #aaa; margin-bottom: 5px;">Phone:</p>
                                <p style="color: white;">${user.phone}</p>
                            </div>
                            <div>
                                <p style="color: #aaa; margin-bottom: 5px;">Joined:</p>
                                <p style="color: white;">${user.joined}</p>
                            </div>
                            <div>
                                <p style="color: #aaa; margin-bottom: 5px;">Tournaments:</p>
                                <p style="color: white;">${user.tournaments}</p>
                            </div>
                            <div>
                                <p style="color: #aaa; margin-bottom: 5px;">Total Winnings:</p>
                                <p style="color: #FFD700; font-weight: bold;">GHS ${user.winnings}</p>
                            </div>
                        </div>
                        <div style="margin-top: 20px;">
                            <button class="btn btn-danger" onclick="deleteUser(${user.id})" style="width: 100%;">
                                üóëÔ∏è Delete User Account
                            </button>
                        </div>
                    </div>
                </div>
            `;

            document.getElementById('userDetailsContent').innerHTML = html;
            openModal('userDetailsModal');
        }

        function toggleUserStatus(id, status) {
            const action = status === 'banned' ? 'ban' : 'unban';
            if (confirm(`Are you sure you want to ${action} this user?`)) {
                alert(`User ${action}ned successfully`);
                // In a real app, call API to update user status
                loadUsers();
            }
        }

        function deleteUser(id) {
            if (confirm('Are you sure you want to delete this user account? This action cannot be undone.')) {
                alert('User account deleted');
                // In a real app, call API to delete user
                loadUsers();
                closeModal('userDetailsModal');
            }
        }

        function searchUsers() {
            const searchTerm = document.getElementById('userSearch').value.toLowerCase();
            const filtered = usersData.filter(u => 
                u.username.toLowerCase().includes(searchTerm) ||
                u.email.toLowerCase().includes(searchTerm) ||
                u.phone.includes(searchTerm)
            );
            displayUsers(filtered);
        }

        function filterUsers() {
            const filter = document.getElementById('userFilter').value;
            const searchTerm = document.getElementById('userSearch').value.toLowerCase();
            
            let filtered = usersData;
            
            if (filter !== 'all') {
                filtered = filtered.filter(u => u.status === filter);
            }
            
            if (searchTerm) {
                filtered = filtered.filter(u => 
                    u.username.toLowerCase().includes(searchTerm) ||
                    u.email.toLowerCase().includes(searchTerm) ||
                    u.phone.includes(searchTerm)
                );
            }
            
            displayUsers(filtered);
        }

        // ==================== NOTIFICATIONS ====================
        function toggleNotificationFields() {
            const type = document.getElementById('notificationType').value;
            document.getElementById('tournamentField').style.display = 
                type === 'tournament' || type === 'winners' ? 'block' : 'none';
            document.getElementById('userField').style.display = 
                type === 'user' ? 'block' : 'none';
        }

        async function loadNotificationOptions() {
            try {
                // Load tournament options
                const tournamentsSelect = document.getElementById('notificationTournament');
                tournamentsSelect.innerHTML = tournamentsData.map(t => 
                    `<option value="${t.id}">${t.title}</option>`
                ).join('');
                
                // Load user options
                const usersSelect = document.getElementById('notificationUser');
                usersSelect.innerHTML = usersData.map(u => 
                    `<option value="${u.id}">${u.username} (${u.email})</option>`
                ).join('');
                
            } catch (error) {
                console.error('Load notification options error:', error);
            }
        }

        document.getElementById('notificationForm').addEventListener('submit', async function(event) {
            event.preventDefault();
            
            const type = document.getElementById('notificationType').value;
            const subject = document.getElementById('notificationSubject').value;
            const message = document.getElementById('notificationMessage').value;
            const tournamentId = document.getElementById('notificationTournament').value;
            const userId = document.getElementById('notificationUser').value;
            const sendInApp = document.getElementById('sendInApp').checked;
            const sendSMS = document.getElementById('sendSMS').checked;
            const sendEmail = document.getElementById('sendEmail').checked;

            // Create notification data
            const notificationData = {
                type,
                subject,
                message,
                sendInApp,
                sendSMS,
                sendEmail,
                timestamp: new Date().toISOString()
            };

            if (type === 'tournament' || type === 'winners') {
                notificationData.tournamentId = tournamentId;
                const tournament = tournamentsData.find(t => t.id == tournamentId);
                notificationData.tournamentTitle = tournament?.title;
            }

            if (type === 'user') {
                notificationData.userId = userId;
                const user = usersData.find(u => u.id == userId);
                notificationData.userName = user?.username;
            }

            try {
                // In a real app, call API to send notification
                alert('Notification sent successfully!');
                
                // Add to notification history
                notificationsData.push(notificationData);
                
                // Reset form
                event.target.reset();
                
            } catch (error) {
                console.error('Send notification error:', error);
                alert('Failed to send notification');
            }
        });

        function showNotificationHistory() {
            const historyDiv = document.getElementById('notificationHistory');
            const table = document.getElementById('notificationHistoryTable');
            
            if (historyDiv.style.display === 'none') {
                // Load history
                table.innerHTML = notificationsData.map(notif => `
                    <tr>
                        <td>${new Date(notif.timestamp).toLocaleDateString()}</td>
                        <td>${notif.type}</td>
                        <td>${notif.subject}</td>
                        <td>
                            ${notif.type === 'all' ? 'All Users' : 
                              notif.type === 'user' ? notif.userName : 
                              notif.type === 'tournament' || notif.type === 'winners' ? notif.tournamentTitle : 'N/A'}
                        </td>
                        <td><span class="status-badge status-success">Sent</span></td>
                    </tr>
                `).join('');
                
                historyDiv.style.display = 'block';
            } else {
                historyDiv.style.display = 'none';
            }
        }

        function sendUserNotification(userId) {
            const user = usersData.find(u => u.id === userId);
            if (!user) return;

            document.getElementById('quickNotificationMessage').value = 
                `Hello ${user.username},\n\n`;
            openModal('sendNotificationModal');
        }

        // ==================== REPORTS ====================
        function updateReportFilters() {
            const period = document.getElementById('reportPeriod').value;
            document.getElementById('customRange').style.display = 
                period === 'custom' ? 'grid' : 'none';
        }

        function generateReport() {
            const type = document.getElementById('reportType').value;
            const period = document.getElementById('reportPeriod').value;
            const fromDate = document.getElementById('reportFromDate').value;
            const toDate = document.getElementById('reportToDate').value;

            let reportHTML = `
                <h3 style="color: #FFD700; margin-bottom: 20px;">üìà Report Generated</h3>
                <div style="background: rgba(255,255,255,0.05); padding: 20px; border-radius: 10px;">
                    <p><strong>Report Type:</strong> ${type}</p>
                    <p><strong>Period:</strong> ${period}${period === 'custom' ? ` (${fromDate} to ${toDate})` : ''}</p>
                    <hr style="margin: 20px 0; border-color: rgba(255,255,255,0.1);">
            `;

            // Sample report data
            if (type === 'revenue') {
                reportHTML += `
                    <p><strong>Total Revenue:</strong> <span class="ghs">GHS 1,250.00</span></p>
                    <p><strong>Average Transaction:</strong> <span class="ghs">GHS 25.00</span></p>
                    <p><strong>Successful Payments:</strong> 45</p>
                    <p><strong>Failed Payments:</strong> 5</p>
                    <p><strong>Most Popular Payment:</strong> MTN MoMo (75%)</p>
                `;
            } else if (type === 'registrations') {
                reportHTML += `
                    <p><strong>Total Registrations:</strong> 150</p>
                    <p><strong>Most Popular Game:</strong> Call of Duty: Mobile</p>
                    <p><strong>Average Entry Fee:</strong> <span class="ghs">GHS 15.00</span></p>
                    <p><strong>Registration Success Rate:</strong> 90%</p>
                `;
            } else if (type === 'users') {
                reportHTML += `
                    <p><strong>Total Users:</strong> 85</p>
                    <p><strong>Active Users:</strong> 75 (88%)</p>
                    <p><strong>New Users This Month:</strong> 15</p>
                    <p><strong>Avg Tournaments per User:</strong> 2.5</p>
                    <p><strong>Avg Winnings per User:</strong> <span class="ghs">GHS 50.00</span></p>
                `;
            } else if (type === 'tournaments') {
                reportHTML += `
                    <p><strong>Total Tournaments:</strong> 8</p>
                    <p><strong>Completed Tournaments:</strong> 5</p>
                    <p><strong>Active Tournaments:</strong> 3</p>
                    <p><strong>Avg Prize Pool:</strong> <span class="ghs">GHS 200.00</span></p>
                    <p><strong>Avg Participants:</strong> 45</p>
                `;
            }

            reportHTML += `
                </div>
                <div style="margin-top: 20px; text-align: center;">
                    <button class="btn btn-primary" onclick="exportReport()">
                        üì• Export Full Report
                    </button>
                </div>
            `;

            document.getElementById('reportResults').innerHTML = reportHTML;
        }

        function exportReport() {
            alert('Report exported successfully!');
            // In a real app, implement report export
        }

        // ==================== UTILITY FUNCTIONS ====================
        function showSection(sectionId) {
            // Hide all sections
            document.querySelectorAll('.admin-section').forEach(section => {
                section.style.display = 'none';
            });
            
            // Remove active class from all nav links
            document.querySelectorAll('.admin-nav a').forEach(link => {
                link.classList.remove('active');
            });
            
            // Show selected section
            document.getElementById(`${sectionId}Section`).style.display = 'block';
            
            // Add active class to selected nav link
            const activeLink = document.querySelector(`.admin-nav a[onclick*="${sectionId}"]`);
            if (activeLink) {
                activeLink.classList.add('active');
            }
            
            // Load section-specific data
            switch(sectionId) {
                case 'notifications':
                    loadNotificationOptions();
                    break;
                case 'reports':
                    updateReportFilters();
                    break;
            }
        }

        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('en-GH', {
                day: 'numeric',
                month: 'short',
                year: 'numeric'
            });
        }

        function openModal(modalId) {
            document.getElementById(modalId).style.display = 'flex';
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        function refreshTournaments() {
            loadTournaments();
            alert('Tournaments refreshed!');
        }

        function exportRegistrations(tournamentId) {
            alert(`Exporting registrations for tournament ${tournamentId}...`);
            // In a real app, implement export functionality
        }

        // ==================== INITIALIZATION ====================
        function initializeAdminPanel() {
            checkAdminAuth();
            
            // Set today's date as default for new tournament
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('tournamentDate').value = today;
            
            // Set tomorrow as default end date for reports
            const tomorrow = new Date();
            tomorrow.setDate(tomorrow.getDate() + 1);
            document.getElementById('reportToDate').value = tomorrow.toISOString().split('T')[0];
        }

        // Load everything when page loads
        document.addEventListener('DOMContentLoaded', initializeAdminPanel);
    </script>
</body>
</html>